FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGFlcm9nZWFyLWRpZ2dlci1hcGIKZGVzY3JpcHRpb246IE1vYmls\
ZSBDSXxDRCBzZXJ2aWNlIHRoYXQgaW50ZWdyYXRlcyB3aXRoIEplbmtpbnMgUGlwZWxpbmVzIHRv\
IHRlc3QgYW5kIGJ1aWxkIHlvdXIgbW9iaWxlIGJpbmFyaWVzLgpiaW5kYWJsZTogRmFsc2UKYXN5\
bmM6IG9wdGlvbmFsCnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1l\
bmFibGVkCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBNb2JpbGUgQ0l8Q0QgKGRldikKICBsb25n\
RGVzY3JpcHRpb246ICJUbyB1c2UgdGhlIE1vYmlsZSBDSXxDRCBzZXJ2aWNlIHlvdSBtdXN0IGZp\
cnN0IGFncmVlIHRvIHRoZSBBbmRyb2lkIFNESyBMaWNlbnNlIEFncmVlbWVudC4gQnkgY2hlY2tp\
bmcgdGhpcyBib3ggeW91IGFyZSBhZ3JlZWluZyB0byB0aGUgQW5kcm9pZCBTb2Z0d2FyZSBEZXZl\
bG9wbWVudCBLaXQgTGljZW5zZSBhZ3JlZW1lbnQgd2hpY2ggY2FuIGJlIHJlYWQgYXQgdGhlIGZv\
bGxvd2luZyBVUkw6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3N0dWRpby90ZXJtcy5o\
dG1sXG5cbi4gSWYgdGhlIGJveCBpcyBub3QgY2hlY2tlZCB0aGUgaW5zdGFsbGVyIHdpbGwgdGFr\
ZSBubyBhY3Rpb24uIgogIHNlcnZpY2VOYW1lOiBhZXJvZ2Vhci1kaWdnZXIKICBpbWFnZVVybDog\
Imh0dHBzOi8vYWVyb2dlYXIub3JnL2ltZy9hZXJvZ2VhcmRpZ2dlcl9pY29uXzMycHhfY3JvcHBl\
ZC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8vYWVyb2dlYXIub3JnL2RpZ2dlci8i\
CiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgogIC0gbmFtZTog\
ZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlZmF1bHQgcGxhbgogICAgZnJlZTogVHJ1ZQogICAg\
bWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBBTkRST0lEX0xJQ0VOU0Vf\
QUdSRUVNRU5UCiAgICAgIGRlZmF1bHQ6ICIiCiAgICAgIHBhdHRlcm46IF55ZXMkCiAgICAgIHR5\
cGU6IHN0cmluZwogICAgICBkZXNjcmlwdGlvbjogIlR5cGUgJ3llcycgYWJvdmUgdG8gYWNjZXB0\
IHRoZSBBbmRyb2lkIFNESyBMaWNlbnNlIEFncmVlbWVudC4gaHR0cHM6Ly9kZXZlbG9wZXIuYW5k\
cm9pZC5jb20vc3R1ZGlvL3Rlcm1zLmh0bWwiCiAgICAgIHRpdGxlOiBBbmRyb2lkIFNESyBMaWNl\
bnNlIEFncmVlbWVudAogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkaXNwbGF5X2dyb3VwOiBB\
bmRyb2lkIFNESwogICAgLSBuYW1lOiBBTkRST0lEX1NES19BVVRPX0NPTkZJRwogICAgICBkZWZh\
dWx0OiAiWWVzIgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV90eXBlOiBlbnVtCiAg\
ICAgIGVudW06IFsiWWVzIiwgIk5vIl0KICAgICAgZGVzY3JpcHRpb246ICJJbnN0YWxscyB0aGUg\
ZGVmYXVsdCBhbmRyb2lkIHNkayBwYWNrYWdlcyIKICAgICAgdGl0bGU6IEFuZHJvaWQgU0RLIEF1\
dG8gSW5zdGFsbAogICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgZGlzcGxheV9ncm91cDogQW5k\
cm9pZCBTREsKICAgIC0gbmFtZTogQU5EUk9JRF9TREtfQ09ORklHCiAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRlc2NyaXB0aW9uOiAiQW5kcm9p\
ZCBTREsgY29uZmlnIGZpbGUgY29udGVudCIKICAgICAgdGl0bGU6IEFuZHJvaWQgU0RLIGNvbmZp\
ZwogICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgdXBkYXRhYmxlOiBUcnVlCiAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IEFuZHJvaWQgU0RLCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
